<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Word Viewer</title>
<style>
    body {
        text-align: center;
        font-family: Arial, sans-serif;
    }
    #wordDisplay span {
        color: blue;
        font-size: 2em;
        font-weight: bold;
    }
    #sentenceDisplay span {
        color: lightgrey;
    }
</style>
</head>
<body>

<select id="fileSelect" onchange="loadWordList()"></select>
<div id="wordDisplay"></div>
<div id="meaningDisplay"></div>
<div id="sentenceDisplay"></div>
<button id="backButton" onclick="displayPreviousWord()">Back</button>
<button onclick="displayNextWord()">Next</button>

<script>
let wordList = [];
let currentIndex = -1;

function displayWord() {
    if (currentIndex >= 0 && currentIndex < wordList.length) {
        const parts = wordList[currentIndex].split('~');
        if (parts.length === 3) {
            document.getElementById('wordDisplay').innerHTML = `<span>${parts[0]}</span>`;
            document.getElementById('meaningDisplay').textContent = parts[1];
            document.getElementById('sentenceDisplay').innerHTML = `<span>${parts[2]}</span>`;
        } else {
            alert('The word entry is not formatted correctly.');
        }
    } else {
        document.getElementById('wordDisplay').textContent = '';
        document.getElementById('meaningDisplay').textContent = '';
        document.getElementById('sentenceDisplay').textContent = '';
    }
    document.getElementById('backButton').disabled = currentIndex <= 0;
}

function displayNextWord() {
    currentIndex++;
    displayWord();
}

function displayPreviousWord() {
    currentIndex--;
    displayWord();
}

function loadWordList() {
    const fileSelect = document.getElementById('fileSelect');
    const selectedFile = fileSelect.options[fileSelect.selectedIndex].text;
    const filePath = `https://raw.githubusercontent.com/lwkwok/lwkwok.github.io/main/App_SpellingTest/${encodeURIComponent(selectedFile)}.txt`;

    fetch(filePath)
        .then(response => {
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            return response.text();
        })
        .then(text => {
            wordList = text.split(/\r?\n/);
            currentIndex = 0;
            displayWord();
        })
        .catch(error => {
            alert('Error fetching the word list: ' + error.message);
        });
}

function populateFileSelect() {
    fetch('https://raw.githubusercontent.com/lwkwok/lwkwok.github.io/main/App_SpellingTest/_index.txt')
        .then(response => response.text())
        .then(text => {
            const fileNames = text.split(/\r?\n/).filter(name => name.trim() !== '');
            const selectElement = document.getElementById('fileSelect');
            selectElement.innerHTML = ''; // Clear existing options if any
            fileNames.forEach(fileName => {
                const option = document.createElement('option');
                option.value = option.textContent = fileName.trim();
                selectElement.appendChild(option);
            });
            loadWordList(); // Load the first list by default
        })
        .catch(error => {
            alert('Error populating file select: ' + error.message);
        });
}

// Call this function on page load to initialize the dropdown and word list
window.addEventListener('load', populateFileSelect);
</script>

</body>
</html>
